SHELL := /bin/bash
.DEFAULT:
	@yad \
	--text="<b>ERROR</b>: Paquete no encontrado. Contactar con un administrador." \
	--center \
	--width=350 \
	--text-align=center \
	--image=dialog-error \
	--borders=15

.PHONY: codeblocks
codeblocks:
	$(call apt-uninstall,codeblocks,Codeblocks)

.PHONY: lazarus
lazarus:
	$(call apt-uninstall,lazarus,Lazarus)

.PHONY: swi-prolog
swi-prolog: 
	$(call apt-uninstall,swi-prolog,SWI-Prolog)

.PHONY: bluej
bluej:
	$(call apt-uninstall,bluej,BlueJ) 

.PHONY: eclipse
eclipse:
	rm ~/.local/share/applications/epp.package.java.desktop;\
	rm ~/.local/share/applications/_home_vdiuser_eclipse-installer_.desktop;\
	$(call generic-uninstall,~/.eclipse,Eclipse)

.PHONY: staruml
staruml:
	$(call apt-uninstall,staruml,StarUML)

.PHONY: logisim
logisim:
	$(call apt-uninstall,logisim,Logisim)

.PHONY: postgresql
postgresql:
	$(call apt-uninstall,postgresql,PostgreSQL)

.PHONY: kotlin
kotlin:
	$(call apt-uninstall,kotlin,Kotlin)

.PHONY: alloy
alloy:
	$(call generic-uninstall, ~/alloy /usr/bin/alloy,Alloy)

.PHONY: android-studio
android-studio:
	$(call generic-uninstall,~/.AndroidStudio ~/.android ~/.local/share/applications/jetbrains-android-studio.desktop,"Android Studio")

.PHONY: visual-studio-code
visual-studio-code:
	$(call apt-uninstall,code,"Visual\ Studio\ Code")

.PHONY: virtualbox
virtualbox:
	@$(call apt-uninstall,virtualbox,VirtualBox);\

.PHONY: mysql
mysql:
	@$(call apt-uninstall,mysql-server,MySQL);
	$(call apt-uninstall,mysql-client,MySQL)

.PHONY: intellij
intellij: 
	@DIRECTORY=$$(ls ~ | grep -o "idea-IC-[0-9]*\.[0-9]*\.[0-9]*" | head -n 1);\
	$(call generic-uninstall,~/$$DIRECTORY,"IntelliJ IDEA")

.PHONY: npm
npm:
	@$(call apt-uninstall,npm,NPM)

.PHONY: projectlibre
projectlibre:
	$(call apt-uninstall,projectlibre,"ProjectLibre")

.PHONY: postman
postman:
	$(call generic-uninstall,~/Postman,Postman)

.PHONY: php
php:
	@$(call apt-uninstall,php,PHP)

.PHONY: pmd
pmd:
	$(call generic-uninstall,~/pmd-bin-* /usr/bin/pmd,PMD)

.PHONY: jenkins
jenkins:
	$(call apt-uninstall,jenkins,Jenkins)

.PHONY: infostat
infostat:
	$(call wine-uninstall)


# =============== Tipos de desinstalación ===============
# Los paquetes, que siguen un patrón marcado de desinstalación
# 
# apt-uninstall: Cuando el paquete se desinstala mediante el comando apt-get remove
#   $1: Nombre del paquete
#   $2: Nombre del programa
#
# generic-uninstall: Cuando el paquete se desinstala únicamente removiendo contenido de directorios.
#   $1: Directorio(s) a eliminar.
#   $2: Nombre del programa
#
# wine-uninstall: Cuando el paquete se instala y desinstala usando Wine

define apt-uninstall
	pkexec apt-get autoremove $1 -y | zenity --progress --pulsate --no-cancel --auto-close --width=350 --text="Desinstalando paquete..." --title="Desinstalación de $2"
endef

define generic-uninstall
	pkexec rm -r $1 | zenity --progress --pulsate --no-cancel --auto-close --width=350 --text="Desinstalando paquete..." --title="Desinstalación de $2"
endef

define wine-uninstall
	yad --title="Desinstalación de programa Wine" --width=400 --borders=15 --button="Ok":0 --text="A continuación se ejecutará el desinstalador de Wine.\nLos programas que no tienen soporte para Linux, se instalan utilizando el utilitario Wine, que simula un entorno de Windows.\nLa desinstalación se hace mediante el utilitario <b>wine uninstaller</b>. Una vez dentro del desinstalador de Wine, seleccionar el programa que se desea eliminar, y desinstalarlo acordemente.";\
	wine uninstaller;\
	exit 0
endef